<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–∏—Å–∫ —Å—Ç–∞—Ç—å–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        .search-form {
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: background-color 0.2s;
            display: inline-block;
        }

        .btn-primary {
            background-color: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2980b9;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #545b62;
        }

        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #f5c6cb;
            margin-bottom: 20px;
        }

        .navigation {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .search-example {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 14px;
            color: #6c757d;
        }

        .search-example h3 {
            margin-bottom: 10px;
            color: #495057;
        }

        .success-message {
            background-color: #d1ecf1;
            color: #0c5460;
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #bee5eb;
            margin-bottom: 20px;
        }

        .search-results {
            margin-top: 20px;
        }

        .result-item {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
        }

        .result-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .result-meta {
            font-size: 0.9em;
            color: #6c757d;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>üîç –ü–æ–∏—Å–∫ —Å—Ç–∞—Ç—å–∏</h1>

    <form class="search-form" id="searchForm">
        <div class="form-group">
            <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏:</label>
            <input type="text" id="title" name="title"
                   placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏"
                   required>
        </div>

        <button type="submit" class="btn btn-primary">–ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é</button>
    </form>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
    <div id="errorMessage" class="error-message" style="display: none;"></div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ -->
    <div id="successMessage" class="success-message" style="display: none;"></div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
    <div id="searchResults" class="search-results"></div>

    <div class="search-example">
        <h3>–ö–∞–∫ –Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é?</h3>
        <p>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –≤ –ø–æ–ª–µ –≤—ã—à–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞–π—Ç–∏ —Å—Ç–∞—Ç—å—é".</p>
        <p>–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –Ω–∞–∑–≤–∞–Ω–∏—è.</p>
    </div>

    <div class="navigation">
        <a href="/articles/editor" class="btn btn-secondary">‚úèÔ∏è –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç–∞—Ç—å—é</a>
        <a href="/articles" class="btn btn-secondary">üìö –í—Å–µ —Å—Ç–∞—Ç—å–∏</a>
        <a href="/" class="btn btn-secondary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const searchForm = document.getElementById('searchForm');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        const searchResults = document.getElementById('searchResults');

        const titleInput = document.getElementById('title');
        if (titleInput) {
            titleInput.focus();
        }

        searchForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const title = titleInput.value.trim();
            if (!title) {
                showError('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞');
                return;
            }

            try {
                // –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô URL - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π endpoint
                const response = await fetch(`/articles/api/search?title=${encodeURIComponent(title)}`);

                if (response.ok) {
                    const articles = await response.json();
                    displayResults(articles, title);
                } else {
                    showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å—Ç–∞—Ç–µ–π. –°—Ç–∞—Ç—É—Å: ' + response.status);
                }
            } catch (error) {
                console.error('Error:', error);
                showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–∏—Å–∫–∞: ' + error.message);
            }
        });

        function displayResults(articles, searchTerm) {
            searchResults.innerHTML = '';

            if (articles.length === 0) {
                showSuccess(`–°—Ç–∞—Ç—å–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É "${searchTerm}" –Ω–µ –Ω–∞–π–¥–µ–Ω—ã`);
                return;
            }

            showSuccess(`–ù–∞–π–¥–µ–Ω–æ —Å—Ç–∞—Ç–µ–π: ${articles.length}`);

            articles.forEach(article => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–≤—Ç–æ—Ä–∞ –∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π
                const authorName = article.author ? article.author.name || article.author.username : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–≤—Ç–æ—Ä';
                const createdAt = article.createdAt ? new Date(article.createdAt).toLocaleDateString() : '–î–∞—Ç–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞';
                const viewCount = article.viewCount || 0;
                const shortDescription = article.shortDescription || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';

                resultItem.innerHTML = `
                    <div class="result-title">
                        <a href="/articles/${article.id}" style="color: #3498db; text-decoration: none;">
                            ${article.title}
                        </a>
                    </div>
                    <div class="result-meta">
                        –ê–≤—Ç–æ—Ä: ${authorName} |
                        –î–∞—Ç–∞: ${createdAt} |
                        –ü—Ä–æ—Å–º–æ—Ç—Ä—ã: ${viewCount}
                    </div>
                    <div style="margin-top: 8px; font-size: 0.9em;">
                        ${shortDescription}
                    </div>
                `;
                searchResults.appendChild(resultItem);
            });
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            successMessage.style.display = 'none';
            searchResults.innerHTML = '';
        }

        function showSuccess(message) {
            successMessage.textContent = message;
            successMessage.style.display = 'block';
            errorMessage.style.display = 'none';
        }
    });
</script>
</body>
</html>